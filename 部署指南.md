# Vercel 部署指南

## 快速部署

### 方式 1: 通过 GitHub（推荐）

1. **准备代码**
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git remote add origin <your-github-repo-url>
   git push -u origin main
   ```

2. **在 Vercel 部署**
   - 访问 https://vercel.com/
   - 点击 "New Project"
   - 选择你的 GitHub 仓库
   - 点击 "Import"
   - Vercel 会自动检测配置
   - 点击 "Deploy"

3. **等待部署完成**
   - 部署完成后会获得一个 URL，例如：`https://your-project.vercel.app`
   - 访问该 URL 即可使用工具

### 方式 2: 使用 Vercel CLI

1. **安装 Vercel CLI**
   ```bash
   npm i -g vercel
   ```

2. **登录**
   ```bash
   vercel login
   ```

3. **部署**
   ```bash
   # 开发环境
   vercel

   # 生产环境
   vercel --prod
   ```

4. **本地测试**
   ```bash
   vercel dev
   ```

## 项目配置

### vercel.json

已配置：
- Python Serverless Functions
- 路由规则
- 函数超时时间（60秒）

### API Functions

- `api/calculate.py`: 计算类目内聚度
- `api/health.py`: 健康检查

### 前端

- `index.html`: 主页面，自动检测 API 地址

## 重要提示

### 1. 模型大小

SBERT 模型可能较大，如果超过 Vercel 限制：

**解决方案：**
- 使用更小的模型（代码中已包含备用模型）
- 升级到 Vercel Pro 计划（250MB 限制）
- 或使用外部模型存储

### 2. 冷启动

首次请求可能需要 10-30 秒加载模型，这是正常的。

### 3. 环境变量

如果需要配置环境变量，在 Vercel 项目设置中添加。

## 验证部署

部署完成后：

1. 访问你的 Vercel URL
2. 输入测试数据：
   ```
   水果:苹果,香蕉,橙子
   ```
3. 点击"开始分析"
4. 应该能看到结果

## 更新部署

代码更新后：

**通过 GitHub：**
- 推送代码到 GitHub
- Vercel 会自动重新部署

**通过 CLI：**
```bash
vercel --prod
```

## 故障排查

### 问题 1: 部署失败

**检查：**
- `vercel.json` 配置是否正确
- `requirements.txt` 是否包含所有依赖
- API 函数格式是否正确

### 问题 2: API 返回错误

**检查：**
- Vercel 函数日志
- 模型是否成功加载
- 请求格式是否正确

### 问题 3: 超时

**解决方案：**
- 检查 `vercel.json` 中的 `maxDuration`
- 考虑使用更小的模型
- 优化代码性能

## 本地测试 Vercel 环境

```bash
vercel dev
```

这会启动本地服务器，模拟 Vercel 环境，方便测试。

## 支持

如有问题，请查看：
- Vercel 文档：https://vercel.com/docs
- 项目日志：Vercel Dashboard > Functions > Logs

