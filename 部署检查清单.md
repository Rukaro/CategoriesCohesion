# Vercel 部署检查清单

## ✅ 已完成的配置

- [x] `vercel.json` 配置文件
- [x] `api/calculate.py` - 计算 API
- [x] `api/health.py` - 健康检查 API
- [x] `index.html` - 前端页面（自动检测 API 地址）
- [x] `requirements.txt` - Python 依赖
- [x] `package.json` - Node.js 配置
- [x] `.vercelignore` - 忽略文件
- [x] `.gitignore` - Git 忽略文件

## 📋 部署前检查

### 1. 文件结构

确保以下文件存在：
```
✅ api/calculate.py
✅ api/health.py
✅ index.html
✅ vercel.json
✅ requirements.txt
✅ package.json
```

### 2. 依赖检查

`requirements.txt` 应包含：
```
flask==3.0.0
flask-cors==4.0.0
sentence-transformers>=2.7.0
torch>=2.0.0
numpy>=1.24.0
scipy>=1.10.0
transformers>=4.30.0
huggingface-hub>=0.20.0
```

### 3. 代码检查

- [x] API 函数使用正确的 handler 格式
- [x] CORS 头已配置
- [x] 错误处理完善
- [x] 前端自动检测 API 地址

## 🚀 部署步骤

### 步骤 1: 准备代码

```bash
# 确保所有文件已提交
git status

# 如果有未提交的文件
git add .
git commit -m "准备部署到 Vercel"
```

### 步骤 2: 推送到 GitHub

```bash
git push origin main
```

### 步骤 3: 在 Vercel 部署

1. 访问 https://vercel.com/
2. 点击 "New Project"
3. 选择 GitHub 仓库
4. 点击 "Import"
5. 确认配置（Vercel 会自动检测）
6. 点击 "Deploy"

### 步骤 4: 等待部署

- 首次部署可能需要 5-10 分钟
- 需要下载和安装 Python 依赖
- 需要下载 SBERT 模型

### 步骤 5: 验证

访问部署后的 URL，测试功能是否正常。

## ⚠️ 注意事项

### 模型大小

- SBERT 模型可能超过 50MB（免费版限制）
- 如果部署失败，考虑：
  1. 使用更小的模型
  2. 升级到 Vercel Pro
  3. 使用外部模型存储

### 冷启动

- 首次请求可能需要 10-30 秒
- 这是正常的，因为需要加载模型
- 后续请求会更快

### 超时设置

- 已配置 60 秒超时
- 如果计算时间较长，可能需要优化

## 🔍 故障排查

### 部署失败

1. 查看 Vercel 构建日志
2. 检查 `requirements.txt` 是否正确
3. 检查 API 函数格式

### API 错误

1. 查看 Vercel 函数日志
2. 检查请求格式
3. 验证模型是否加载成功

### 前端错误

1. 检查浏览器控制台
2. 验证 API 地址是否正确
3. 检查 CORS 配置

## 📞 获取帮助

- Vercel 文档：https://vercel.com/docs
- Vercel 社区：https://github.com/vercel/vercel/discussions
- 项目 Issues：在 GitHub 仓库中提交

